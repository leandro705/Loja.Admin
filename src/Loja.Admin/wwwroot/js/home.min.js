var pages = pages || {};
pages.home = pages.home || {};

pages.home.model = function () {

    var vmUsuarioLogado = function (usuarioLogado) {
        var self = this;

        self.id = ko.observable(usuarioLogado.id);
        self.nome = ko.observable(usuarioLogado.userName);
        self.email = ko.observable(usuarioLogado.email);
        self.perfil = ko.observable(usuarioLogado.role);
        
    };

    return {       
        vmUsuarioLogado
    };
}();
var pages = pages || {};
pages.home = pages.home || {};

pages.home.services = function () {  

    var EPerfil = {
        ADMINISTRADOR: "Administrador",
        GERENTE: "Gerente",
        CLIENTE: "Cliente",
        FUNCIONARIO: "Funcionario"
    }; 

    var login = function (parametro) {
        var url = pages.metadata.actionUrl("/api/authentication/login");
        return pages.dataServices.postAjax(url, parametro);
    }  

    return {
        EPerfil,
        login
    };
}();
var pages = pages || {};
pages.home = pages.home || {};
pages.home.model = pages.home.model || {};
pages.home.services = pages.home.services || {};

pages.metadata = pages.metadata || {};
pages.dataServices = pages.dataServices || {};
pages.utils = pages.utils || {};

pages.home.viewModel = function () {   
    var model = pages.home.model;
    var service = pages.home.services;

    ko.applyBindings(new function () {
        var self = this;       
        
        self.usuarioLogado = ko.observable(new model.vmUsuarioLogado(getDataToken()));  

        self.exibeMenuDashboard = ko.computed(function () {            
            if (self.usuarioLogado() && self.usuarioLogado().perfil() === service.EPerfil.ADMINISTRADOR)
                return true;

            return false;
        });

        self.exibeMenuCalendario = ko.computed(function () {           
            if (self.usuarioLogado() &&
                (
                    self.usuarioLogado().perfil() === service.EPerfil.ADMINISTRADOR ||
                    self.usuarioLogado().perfil() === service.EPerfil.CLIENTE
                ))
                return true;

            return false;
        });

    }, binding);
}();